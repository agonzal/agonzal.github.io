<svg id="mermaid-1615082115904" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="388" style="max-width: 649.183349609375px;" viewBox="-20 -20 649.183349609375 388"><style>#mermaid-1615082115904{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1615082115904 .error-icon{fill:#552222;}#mermaid-1615082115904 .error-text{fill:#552222;stroke:#552222;}#mermaid-1615082115904 .edge-thickness-normal{stroke-width:2px;}#mermaid-1615082115904 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1615082115904 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1615082115904 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1615082115904 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1615082115904 .marker{fill:#333333;stroke:#333333;}#mermaid-1615082115904 .marker.cross{stroke:#333333;}#mermaid-1615082115904 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1615082115904 g.classGroup text{fill:#9370DB;fill:#131300;stroke:none;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:10px;}#mermaid-1615082115904 g.classGroup text .title{font-weight:bolder;}#mermaid-1615082115904 .classTitle{font-weight:bolder;}#mermaid-1615082115904 .node rect,#mermaid-1615082115904 .node circle,#mermaid-1615082115904 .node ellipse,#mermaid-1615082115904 .node polygon,#mermaid-1615082115904 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1615082115904 .divider{stroke:#9370DB;stroke:1;}#mermaid-1615082115904 g.clickable{cursor:pointer;}#mermaid-1615082115904 g.classGroup rect{fill:#ECECFF;stroke:#9370DB;}#mermaid-1615082115904 g.classGroup line{stroke:#9370DB;stroke-width:1;}#mermaid-1615082115904 .classLabel .box{stroke:none;stroke-width:0;fill:#ECECFF;opacity:0.5;}#mermaid-1615082115904 .classLabel .label{fill:#9370DB;font-size:10px;}#mermaid-1615082115904 .relation{stroke:#333333;stroke-width:1;fill:none;}#mermaid-1615082115904 .dashed-line{stroke-dasharray:3;}#mermaid-1615082115904 #compositionStart,#mermaid-1615082115904 .composition{fill:#333333 !important;stroke:#333333 !important;stroke-width:1;}#mermaid-1615082115904 #compositionEnd,#mermaid-1615082115904 .composition{fill:#333333 !important;stroke:#333333 !important;stroke-width:1;}#mermaid-1615082115904 #dependencyStart,#mermaid-1615082115904 .dependency{fill:#333333 !important;stroke:#333333 !important;stroke-width:1;}#mermaid-1615082115904 #dependencyStart,#mermaid-1615082115904 .dependency{fill:#333333 !important;stroke:#333333 !important;stroke-width:1;}#mermaid-1615082115904 #extensionStart,#mermaid-1615082115904 .extension{fill:#333333 !important;stroke:#333333 !important;stroke-width:1;}#mermaid-1615082115904 #extensionEnd,#mermaid-1615082115904 .extension{fill:#333333 !important;stroke:#333333 !important;stroke-width:1;}#mermaid-1615082115904 #aggregationStart,#mermaid-1615082115904 .aggregation{fill:#ECECFF !important;stroke:#333333 !important;stroke-width:1;}#mermaid-1615082115904 #aggregationEnd,#mermaid-1615082115904 .aggregation{fill:#ECECFF !important;stroke:#333333 !important;stroke-width:1;}#mermaid-1615082115904 .edgeTerminals{font-size:11px;}#mermaid-1615082115904:root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}#mermaid-1615082115904 class{fill:apa;}</style><g></g><defs><marker id="extensionStart" class="extension" refX="0" refY="7" markerWidth="190" markerHeight="240" orient="auto"><path d="M 1,7 L18,13 V 1 Z"></path></marker></defs><defs><marker id="extensionEnd" refX="19" refY="7" markerWidth="20" markerHeight="28" orient="auto"><path d="M 1,1 V 13 L18,7 Z"></path></marker></defs><defs><marker id="compositionStart" class="extension" refX="0" refY="7" markerWidth="190" markerHeight="240" orient="auto"><path d="M 18,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker id="compositionEnd" refX="19" refY="7" markerWidth="20" markerHeight="28" orient="auto"><path d="M 18,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker id="aggregationStart" class="extension" refX="0" refY="7" markerWidth="190" markerHeight="240" orient="auto"><path d="M 18,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker id="aggregationEnd" refX="19" refY="7" markerWidth="20" markerHeight="28" orient="auto"><path d="M 18,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker id="dependencyStart" class="extension" refX="0" refY="7" markerWidth="190" markerHeight="240" orient="auto"><path d="M 5,7 L9,13 L1,7 L9,1 Z"></path></marker></defs><defs><marker id="dependencyEnd" refX="19" refY="7" markerWidth="20" markerHeight="28" orient="auto"><path d="M 18,7 L9,13 L14,7 L9,1 Z"></path></marker></defs><g id="classid-EXCHANGEHASHH-11885" class="classGroup" transform="translate(219.57500457763672,0 )"><rect x="0" y="0" width="111.05000305175781" height="33" class=" "></rect><text y="15" x="0"><tspan class="title" x="5">EXCHANGEHASHH</tspan></text><line x1="0" y1="23" y2="23" x2="111.05000305175781"></line><text x="5" y="33" fill="white" class="classText"></text><line x1="0" y1="28" y2="28" x2="111.05000305175781"></line><text x="5" y="43" fill="white" class="classText"></text></g><g id="classid-HASH256-11886" class="classGroup" transform="translate(243.84167289733887,83 )"><rect x="0" y="0" width="62.516666412353516" height="33" class=" "></rect><text y="15" x="0"><tspan class="title" x="5">HASH256</tspan></text><line x1="0" y1="23" y2="23" x2="62.516666412353516"></line><text x="5" y="33" fill="white" class="classText"></text><line x1="0" y1="28" y2="28" x2="62.516666412353516"></line><text x="5" y="43" fill="white" class="classText"></text></g><g id="classid-ClientKEXEphemeralKeyp-11887" class="classGroup" transform="translate(232.5500087738037,297 )"><rect x="0" y="0" width="153.39999389648438" height="46" class=" "></rect><text y="15" x="0"><tspan class="title" x="5">ClientKEXEphemeralKeyp</tspan></text><line x1="0" y1="23" y2="23" x2="153.39999389648438"></line><text x="5" y="33" fill="white" class="classText"><tspan x="5">+PubKey A</tspan></text><line x1="0" y1="41" y2="41" x2="153.39999389648438"></line><text x="5" y="56" fill="white" class="classText"></text></g><g id="classid-ServerKEXEphemeralKeyp-11888" class="classGroup" transform="translate(0,176 )"><rect x="0" y="0" width="157.6666717529297" height="56" class=" "></rect><text y="15" x="0"><tspan class="title" x="5">ServerKEXEphemeralKeyp</tspan></text><line x1="0" y1="23" y2="23" x2="157.6666717529297"></line><text x="5" y="33" fill="white" class="classText"><tspan x="5">PrivKey b</tspan><tspan x="5" dy="10">+PubKey b</tspan></text><line x1="0" y1="51" y2="51" x2="157.6666717529297"></line><text x="5" y="66" fill="white" class="classText"></text></g><g id="classid-ServerHostKeyp-11889" class="classGroup" transform="translate(508.05000495910645,292 )"><rect x="0" y="0" width="101.13333129882812" height="56" class=" "></rect><text y="15" x="0"><tspan class="title" x="5">ServerHostKeyp</tspan></text><line x1="0" y1="23" y2="23" x2="101.13333129882812"></line><text x="5" y="33" fill="white" class="classText"><tspan x="5">+PubKey H</tspan><tspan x="5" dy="10">PrivKey H</tspan></text><line x1="0" y1="51" y2="51" x2="101.13333129882812"></line><text x="5" y="66" fill="white" class="classText"></text></g><g id="classid-SHAREDSECRETK-11890" class="classGroup" transform="translate(372.53334045410156,176 )"><rect x="0" y="0" width="106.5999984741211" height="56" class=" "></rect><text y="15" x="0"><tspan class="title" x="5">SHAREDSECRETK</tspan></text><line x1="0" y1="23" y2="23" x2="106.5999984741211"></line><text x="5" y="33" fill="white" class="classText"><tspan x="5">+Server PrivKey</tspan><tspan x="5" dy="10">+Client KEX</tspan></text><line x1="0" y1="51" y2="51" x2="106.5999984741211"></line><text x="5" y="66" fill="white" class="classText"></text></g><g id="classid-MAGICSM-11891" class="classGroup" transform="translate(227.6666717529297,166 )"><rect x="0" y="0" width="94.86666870117188" height="76" class=" "></rect><text y="15" x="0"><tspan class="title" x="20.30000114440918">MAGICSM</tspan></text><line x1="0" y1="23" y2="23" x2="94.86666870117188"></line><text x="5" y="33" fill="white" class="classText"><tspan x="5">+client version</tspan><tspan x="5" dy="10">+server version</tspan><tspan x="5" dy="10">+client kexinit</tspan><tspan x="5" dy="10">+server kexinit</tspan></text><line x1="0" y1="71" y2="71" x2="94.86666870117188"></line><text x="5" y="86" fill="white" class="classText"></text></g><path d="M275.1000061035156,33L275.1000061035156,37.166666666666664C275.1000061035156,41.333333333333336,275.1000061035156,49.666666666666664,275.1000061035156,58C275.1000061035156,66.33333333333333,275.1000061035156,74.66666666666667,275.1000061035156,78.83333333333333L275.1000061035156,83" id="edge4512" class="relation" marker-start="url(#extensionStart)"></path><path d="M243.84167289733887,115.23660507943671L235.31250603993735,119.53050423286392C226.7833391825358,123.82440338629114,209.72500546773276,132.41220169314556,201.1958386103312,147.20610084657278C192.6666717529297,162,192.6666717529297,183,192.6666717529297,204C192.6666717529297,225,192.6666717529297,246,203.66509948586517,261.5C214.66352721880068,277,236.66038268467165,287,247.65881041760713,292L258.65723815054264,297" id="edge4513" class="relation" marker-start="url(#extensionStart)"></path><path d="M243.84167289733887,106.10948100131137L216.34028339385986,111.9245675010928C188.83889389038086,117.73965400087424,133.83611488342285,129.3698270004371,106.33472537994385,141.0182468335519C78.83333587646484,152.66666666666666,78.83333587646484,164.33333333333334,78.83333587646484,170.16666666666666L78.83333587646484,176" id="edge4514" class="relation" marker-start="url(#extensionStart)"></path><path d="M306.3583393096924,104.92694532484991L340.98750591278076,110.93912110404159C375.61667251586914,116.95129688323327,444.8750057220459,128.97564844161664,479.5041723251343,145.48782422080833C514.1333389282227,162,514.1333389282227,183,514.1333389282227,204C514.1333389282227,225,514.1333389282227,246,517.6304561986864,260.6666666666667C521.12757346915,275.3333333333333,528.1218080100773,283.6666666666667,531.618925280541,287.8333333333333L535.1160425510046,292" id="edge4515" class="relation" marker-start="url(#extensionStart)"></path><path d="M479.13333892822266,227.51745074415118L494.04722754160565,234.09787562012596C508.9611161549886,240.67830049610077,538.7888933817545,253.83915024805037,552.9166184731249,264.5862417906919C567.0443435644953,275.3333333333333,565.4720165204702,283.6666666666667,564.6858529984576,287.8333333333333L563.899689476445,292" id="edge4516" class="relation" marker-start="url(#extensionStart)"></path><path d="M425.8333396911621,232L425.8333396911621,237.83333333333334C425.8333396911621,243.66666666666666,425.8333396911621,255.33333333333334,414.83491195822666,266.1666666666667C403.83648422529114,277,381.8396287594201,287,370.84120102648467,292L359.84277329354916,297" id="edge4517" class="relation" marker-start="url(#extensionStart)"></path><path d="M306.3583393096924,108.10606474481004L326.2708393732707,113.58838728734169C346.18333943684894,119.07070982987337,386.00833956400555,130.03535491493668,405.9208396275838,141.35101079080167C425.8333396911621,152.66666666666666,425.8333396911621,164.33333333333334,425.8333396911621,170.16666666666666L425.8333396911621,176" id="edge4518" class="relation" marker-start="url(#extensionStart)"></path><path d="M275.1000061035156,116L275.1000061035156,120.16666666666667C275.1000061035156,124.33333333333333,275.1000061035156,132.66666666666666,275.1000061035156,141C275.1000061035156,149.33333333333334,275.1000061035156,157.66666666666666,275.1000061035156,161.83333333333334L275.1000061035156,166" id="edge4519" class="relation" marker-start="url(#extensionStart)"></path></svg>